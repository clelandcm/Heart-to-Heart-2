---
title: "H2H Screening Details"
author: "Last Updated"
date: '`r format(Sys.time(), "%B %d, %Y %r %Z")`'
output:
  html_document:
    highlight: tango
    theme: cerulean
    toc: yes
    toc_depth: 5
    css: wide.css
  word_document:
    toc: yes
    toc_depth: '5'
always_allow_html: yes
---

```{r setup, include=FALSE}
options(width = 150)
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, comment=NA, fig.height = 7, fig.width = 10, dpi=600, out.width="1536px", height="864px")
```

```{r}
library(redcapAPI)
library(openxlsx)
library(tidyr)
library(dplyr)
library(ggplot2)
library(DiagrammeR)
library(ggthemes)
library(scales)
library(DiagrammeRsvg)
library(svglite)
library(rsvg)
library(png)
library(XML)
```

```{r}
load("c:/chuck/NYU/NoART/Backups/hth.Rdata", .GlobalEnv)
```

# Screen 1
## Interview Date
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_date)) %>%
  ggplot(aes(x = scr1_date)) + 
  geom_histogram(fill = "blue", color = "white") +
  labs(y = "Interviews", x = "") +
  theme_minimal() +
  theme(text = element_text(size=16))
```

## How did you hear about us?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_recruited)) %>%
  count(scr1_recruited) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

## Where is this interview taking place?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_loc)) %>%
  count(scr1_loc) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

## Does the participant consent to pre-screening?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_prescr_consent)) %>%
  count(scr1_prescr_consent) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

## As far as you remember, did you participate in the "Heart to Heart 1" Project, which was conducted by NYU in 2012-2014?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_hth1)) %>%
  count(scr1_hth1) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

## What was your biological sex at birth?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_sex)) %>%
  count(scr1_sex) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

## Current age (automatically calculated)
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_auto_age)) %>%
  ggplot(aes(x = scr1_auto_age)) + 
  geom_histogram(fill = "blue", color = "white") +
  labs(y = "Number of People", x = "Age") +
  theme_minimal() +
  theme(text = element_text(size=16))
```

## Younger than 36
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(rand_condition)) %>%
  count(rand_condition) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

## Where have you been living during the past month, that is, what borough or other location?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_livingin)) %>%
  count(scr1_livingin) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

## Do you have any plans to leave the New York City metropolitan area in the next year?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_leave)) %>%
  count(scr1_leave) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

## Do you consider yourself Hispanic/ Latino?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_ethnicity)) %>%
  count(scr1_ethnicity) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

## How would you describe your racial background: that is, which group or groups describe you best?
### a, Native American or Alaskan Native
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_race___a)) %>%
  count(scr1_race___a) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

### b, Asian
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_race___b)) %>%
  count(scr1_race___b) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

### c, Black or African-American
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_race___c)) %>%
  count(scr1_race___c) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

### d, Native Hawaiian or Pacific Islander
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_race___d)) %>%
  count(scr1_race___d) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

### e, White
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_race___e)) %>%
  count(scr1_race___e) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

### f, Other
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_race___f)) %>%
  count(scr1_race___f) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

### g, Don't Know
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_race___g)) %>%
  count(scr1_race___g) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

### h, Refuse to Answer
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_race___h)) %>%
  count(scr1_race___h) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

## Can you take part in activities that are conducted in English and/ or Spanish?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_lang)) %>%
  count(scr1_lang) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

## Have you ever been told you have HIV?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_hivstat)) %>%
  count(scr1_hivstat) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

## Think about when you were first told you have HIV. Was that within the past 6 months?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_firsthiv_6mths)) %>%
  count(scr1_firsthiv_6mths) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

## Was that within the past year?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_firsthiv_recently)) %>%
  count(scr1_firsthiv_recently) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

## We know people sometimes decide not to start HIV medication, or they start and stop HIV medication. In your whole life, have you ever taken HIV medication, also called antiretroviral therapy?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_hivmeds)) %>%
  count(scr1_hivmeds) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

## Have you taken HIV medication or antiretroviral therapy at all in the past 6 weeks?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_meds_past6wks)) %>%
  count(scr1_meds_past6wks) %>%
  mutate(Percent = round(prop.table(n) * 100, 1)) %>%
  knitr::kable()
```

## How much of your HIV medication did you take in the past 6 weeks?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_meds_past6wks_q1)) %>%
  summarize(n = n(),
            Mean = round(mean(scr1_meds_past6wks_q1, na.rm = TRUE)),
            sd = round(sd(scr1_meds_past6wks_q1, na.rm = TRUE)),
            Median = round(median(scr1_meds_past6wks_q1, na.rm = TRUE)),
            IQR = round(IQR(scr1_meds_past6wks_q1, na.rm = TRUE)),
            Min = min(scr1_meds_past6wks_q1, na.rm = TRUE),
            Max = max(scr1_meds_past6wks_q1, na.rm = TRUE)) %>%
  knitr::kable()

hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_meds_past6wks_q1)) %>%
  ggplot(aes(x = scr1_meds_past6wks_q1)) +
  geom_density(fill="#4169E1", alpha = .33) +
  scale_x_continuous(limits=c(0,100), breaks = seq(0,100,5)) +
  theme_minimal() +
  theme(text = element_text(size=16)) +
  labs(x = "Medication Adherence")
```


## Did you take at least one HIV viral load test in the past 6 months?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_meds_past6wks_q2)) %>%
  group_by(scr1_meds_past6wks_q2) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## We want to know the result of your last HIV viral load. Were you told the result of that viral load test was "undetectable"?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_meds_past6wks_q3)) %>%
  group_by(scr1_meds_past6wks_q3) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Have you ever seen a health care provider specifically for your HIV medical care?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_provider)) %>%
  group_by(scr1_provider) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## We know it can be hard to make it to health care appointments. In the past year, how many different times have you seen a health care provider specifically for your HIV medical care, if at all? 
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_appts)) %>%
  mutate(scr1_appts = car::recode(scr1_appts, "5:hi='5 or more'")) %>%
  group_by(scr1_appts) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Think about these appointments you attended for HIV Care. Were 2 of them at least 3 months apart, as far as you remember?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_appts_apart)) %>%
  group_by(scr1_appts_apart) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## We know people sometimes have to miss their scheduled appointments without cancelling in advance. In the past year, how many appointments with your HIV health care provider have you missed?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_appts_miss_year)) %>%
  group_by(scr1_appts_miss_year) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## We know people sometimes have to miss their scheduled appointments without cancelling in advance. In the past six months, how many appointments with your HIV health care provider have you missed?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_appts_miss_recently)) %>%
  group_by(scr1_appts_miss_recently) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## During the past month, how often have you heard noises or voices that other people say they can't hear?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_noises)) %>%
  group_by(scr1_noises) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Now we would like to ask about your experience with this interview. How likely would you be to recommend this interview to someone else?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_recommend)) %>%
  group_by(scr1_recommend) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Are any of the following true, making the participant ineligible for the study?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_ineligibles)) %>%
  group_by(scr1_ineligibles) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Do you have written documentation of your HIV status with you today and would you be willing to show it to the interviewer now? 
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_docs)) %>%
  group_by(scr1_docs) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Select the written documentation you have seen of participant HIV status
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_docs_choices)) %>%
  group_by(scr1_docs_choices) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Would you be willing and able to provide written documentation of your HIV status later to participate in another part of this study?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1" & !is.na(scr1_docs_notice)) %>%
  group_by(scr1_docs_notice) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Reasons for Ineligibility
### No Consent
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1") %>%
  mutate(No_Consent = scr1_prescr_consent == 'No') %>%
  group_by(No_Consent) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

### Too Young (<18)
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1") %>%
  mutate(Too_Young = scr1_auto_age < 18) %>%
  group_by(Too_Young) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

### Too Old (>65)
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1") %>%
  mutate(Too_Old = scr1_auto_age > 65) %>%
  group_by(Too_Old) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

### Residence Outside of Study Area
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1") %>%
  mutate(Outside_NYC = scr1_livingin %in% c('Outside NYC metropolitan area', 'Refuse to Answer')) %>%
  group_by(Outside_NYC) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

### Planning to Leave Study Area Within Next Year
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1") %>%
  mutate(Leaving_NYC = scr1_leave == "Yes") %>%
  group_by(Leaving_NYC) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

### Neither Latino/Latina Nor African-American
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1") %>%
  mutate(RACETH = (scr1_ethnicity == 'No' | scr1_ethnicity == 'Refuse to Answer') & 
           (scr1_race___a == 'Checked' | scr1_race___b == 'Checked' | scr1_race___d == 'Checked' | scr1_race___e == 'Checked' | scr1_race___f == 'Checked' | scr1_race___g == 'Checked') & 
           scr1_race___c != 'Checked') %>%
  group_by(RACETH) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

### Cannot Take Part in Activities in Either English or Spanish
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1") %>%
  mutate(Language = scr1_lang != "Yes") %>%
  group_by(Language) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

### Participated in HTH1
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1") %>%
  mutate(HTH1 = scr1_hth1 != "No") %>%
  group_by(HTH1) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

### Does Not Self-Report HIV Infection
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1") %>%
  mutate(HIVNEG = scr1_hivstat == "No") %>%
  group_by(HIVNEG) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

### Diagnosed with HIV Infection Within the Past Six Months
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1") %>%
  mutate(RECENTDX = scr1_firsthiv_6mths == "Yes") %>%
  group_by(RECENTDX) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

### Took ART Within the Past Six Weeks
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1") %>%
  mutate(RECENTART = scr1_meds_past6wks == "Yes") %>%
  group_by(RECENTART) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

### Good HIV Appointment Attendance 
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1") %>%
  mutate(ENGAGED = (scr1_firsthiv_recently == 'Yes' & scr1_appts > 0 & scr1_appts_miss_recently == 'Never missed an appointment') |
                   (scr1_firsthiv_recently == 'No' & scr1_appts > 2 & scr1_appts_apart == 'Yes' & 
                      (scr1_appts_miss_year == 'Never missed an appointment' | scr1_appts_miss_year == 'Once in the past year'))) %>%
  group_by(ENGAGED) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

### Often Heard Noises or Voices Other People Cannot Hear
```{r}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1") %>%
  mutate(Noises = scr1_noises %in% c('Fairly often', 'Very often', 'Refuse to Answer')) %>%
  group_by(Noises) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

```{r, eval = FALSE}
hth %>% 
  filter(redcap_event_name == "screen_1_arm_1") %>%
  mutate(No_Consent = scr1_prescr_consent == 'No',
         Too_Young = scr1_auto_age < 18,
         Too_Old = scr1_auto_age > 65,
         Outside_NYC = scr1_livingin %in% c('Outside NYC metropolitan area', 'Refuse to Answer'),
         Leaving_NYC = scr1_leave == "Yes",
         RACETH = (scr1_ethnicity == 'No' | scr1_ethnicity == 'Refuse to Answer') & 
           (scr1_race___a == 'Checked' | scr1_race___b == 'Checked' | scr1_race___d == 'Checked' | scr1_race___e == 'Checked' | scr1_race___f == 'Checked' | scr1_race___g == 'Checked') & 
           scr1_race___c != 'Checked',
         Language = scr1_lang != "Yes",
         HTH1 = scr1_hth1 != "No",
         HIVNEG = scr1_hivstat == "No",
         RECENTDX = scr1_firsthiv_6mths == "Yes",
         RECENTART = scr1_meds_past6wks == "Yes",
         ENGAGED = (scr1_firsthiv_recently == 'Yes' & scr1_appts > 0 & scr1_appts_miss_recently == 'Never missed an appointment') |
                   (scr1_firsthiv_recently == 'No' & scr1_appts > 2 & scr1_appts_apart == 'Yes' & 
                      (scr1_appts_miss_year == 'Never missed an appointment' | scr1_appts_miss_year == 'Once in the past year')),
         Noises = scr1_noises %in% c('Fairly often', 'Very often', 'Refuse to Answer'),
         Engaged_Only = ENGAGED & !No_Consent & !Too_Young & !Too_Old & !Outside_NYC & !Leaving_NYC & !RACETH & !Language & !HTH1 & !HIVNEG & !RECENTDX & !RECENTART & !Noises) %>%
  select(ENGAGED, Engaged_Only) %>%
  with(table(Engaged_Only, useNA = "always"))
```

# Screen 2A
## Interview Date
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2a_arm_1" & !is.na(scr2a_date)) %>%
  ggplot(aes(x = scr2a_date)) + 
  geom_histogram(fill = "blue", color = "white") +
  labs(y = "Interviews", x = "") +
  theme_minimal() +
  theme(text = element_text(size=16))
```

## Do you agree to give us information so we can contact you in the future? You can decline to give us contact information, but you will need to give us contact information to participate in this study.
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2a_arm_1" & !is.na(scr2a_consent_contact)) %>%
  group_by(scr2a_consent_contact) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Do you agree to show us proof of your HIV status? You can decline to provide proof of HIV status, but you will need to show us proof of your HIV status to participate in this study.
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2a_arm_1" & !is.na(scr2a_consent_proof_status)) %>%
  group_by(scr2a_consent_proof_status) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Do you agree to give us a hair sample or blood sample?  You can decline to give a hair or blood sample, but you need to give us a hair or blood sample to participate in this study.
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2a_arm_1" & !is.na(scr2a_consent_sample)) %>%
  group_by(scr2a_consent_sample) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Participant signature for HTH2 screening consent form obtained?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2a_arm_1" & !is.na(scr2a_consent_sign_comp)) %>%
  group_by(scr2a_consent_sign_comp) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Do you have written documentation of your HIV status with you today and would you be willing to show it to the interviewer now? 
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2a_arm_1" & !is.na(scr2a_docs)) %>%
  group_by(scr2a_docs) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Select the written document you have seen of participant HIV status
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2a_arm_1" & !is.na(scr2a_docs_choices)) %>%
  group_by(scr2a_docs_choices) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Please write the name of the written document you have seen that documents the participant's HIV status:
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2a_arm_1" & !is.na(scr2a_docs_other)) %>%
  select(scr2a_docs_other) %>%
  knitr::kable()
```

## Would you be willing to provide a few pieces of hair from your head that we will test for HIV medications? This test is only for the research and not for medical reasons.
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2a_arm_1" & !is.na(scr2a_hairsampleconsent)) %>%
  group_by(scr2a_hairsampleconsent) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Would you be willing to have a sample of your blood taken by a needle so that we may test it for CD4 count and HIV viral load? This test is only for the research and not for medical reasons.
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2a_arm_1" & !is.na(scr2a_docs)) %>%
  group_by(scr2a_docs) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Would you be willing to let the study contact your medical provider, if you have one, to get information about your care? This is only for the research and not for medical reasons.
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2a_arm_1" & !is.na(scr2a_bloodsampleconsent)) %>%
  group_by(scr2a_bloodsampleconsent) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Would you be willing to let the study contact your medical provider, if you have one, to get information about your care? This is only for the research and not for medical reasons.
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2a_arm_1" & !is.na(scr2a_mrfconsent)) %>%
  group_by(scr2a_mrfconsent) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Would you be willing to participate in a one-time program (lasting about 1 hour) with a staff member where you learn more about the study and HIV disease and treatments?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2a_arm_1" & !is.na(scr2a_particpateconsent)) %>%
  group_by(scr2a_particpateconsent) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Would you be willing to be randomly assigned, which means being chosen by chance, to participate in one or more programs that focus on HIV care and treatment, for between about 3 and 8 months?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2a_arm_1" & !is.na(sc2a_randconsent)) %>%
  group_by(sc2a_randconsent) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Is the participant preliminarily eligible?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2a_arm_1" & !is.na(scr2a_prelim_eligibility)) %>%
  group_by(scr2a_prelim_eligibility) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

# Screen 2B
## Interview Date
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2b_arm_1" & !is.na(scr2b_date)) %>%
  ggplot(aes(x = scr2b_date)) + 
  geom_histogram(fill = "blue", color = "white") +
  labs(y = "Interviews", x = "") +
  theme_minimal() +
  theme(text = element_text(size=16))
```

## Hair sample obtained?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2b_arm_1" & !is.na(scr2b_sample_hair)) %>%
  group_by(scr2b_sample_hair) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Date hair sample collected.
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2b_arm_1" & !is.na(scr2b_shair_collectdate)) %>%
  ggplot(aes(x = scr2b_shair_collectdate)) + 
  geom_histogram(fill = "blue", color = "white") +
  labs(y = "Samples", x = "") +
  theme_minimal() +
  theme(text = element_text(size=16))
```

## ART detected?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2b_arm_1") %>%
  group_by(scr2b_shair_status) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Blood sample collected?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2b_arm_1" & !is.na(scr2b_sample_blood)) %>%
  group_by(scr2b_sample_blood) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Date blood sample collected.
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2b_arm_1" & !is.na(scr2b_sblood_collectdate)) %>%
  ggplot(aes(x = scr2b_sblood_collectdate)) + 
  geom_histogram(fill = "blue", color = "white") +
  labs(y = "Samples", x = "") +
  theme_minimal() +
  theme(text = element_text(size=16))
```

## Date blood sample sent.
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2b_arm_1" & !is.na(scr2b_sblood_sentdate)) %>%
  ggplot(aes(x = scr2b_sblood_sentdate)) + 
  geom_histogram(fill = "blue", color = "white") +
  labs(y = "Samples", x = "") +
  theme_minimal() +
  theme(text = element_text(size=16))
```

## Date blood sample results received.
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2b_arm_1" & !is.na(scr2b_sblood_resultdate)) %>%
  ggplot(aes(x = scr2b_sblood_resultdate)) + 
  geom_histogram(fill = "blue", color = "white") +
  labs(y = "Results", x = "") +
  theme_minimal() +
  theme(text = element_text(size=16))
```

## Name of blood test performed.
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2b_arm_1" & !is.na(scr2b_sblood_ttype)) %>%
  group_by(scr2b_sblood_ttype) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## Please write the name of the blood test performed:
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2b_arm_1" & !is.na(scr2b_sblood_ttype_other)) %>%
  select(scr2b_sblood_ttype_other) %>%
  knitr::kable()
```

## Blood sample result <= 1000 pp/mL?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2b_arm_1" & !is.na(scr2b_sblood_status)) %>%
  group_by(scr2b_sblood_status) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```

## If No, enter absolute value (log10 transformed)
```{r}
hth %>% 
  filter(!is.na(scr2b_sblood_status_value)) %>%
  mutate(VL = log10(scr2b_sblood_status_value)) %>% 
  summarize(n = n(),
            Mean = round(mean(VL, na.rm = TRUE)),
            sd = round(sd(VL, na.rm = TRUE)),
            Median = round(median(VL, na.rm = TRUE)),
            IQR = round(IQR(VL, na.rm = TRUE)),
            Min = min(VL, na.rm = TRUE),
            Max = max(VL, na.rm = TRUE)) %>%
  knitr::kable()

hth %>% 
  filter(!is.na(scr2b_sblood_status_value)) %>%
  mutate(log10VL = log10(scr2b_sblood_status_value)) %>%
  ggplot(aes(x = log10VL)) +
  geom_density(fill="#4169E1", alpha = .33) +
  scale_x_continuous(limits=c(0,10), breaks = seq(0,10,1)) +
  theme_minimal() +
  theme(text = element_text(size=16))
```

## Is the participant eligible?
```{r}
hth %>% 
  filter(redcap_event_name == "screen_2b_arm_1" & !is.na(scr2b_final_eligibility)) %>%
  group_by(scr2b_final_eligibility) %>%
  tally() %>% 
  rename(Count = n) %>% 
  mutate(Percent = round(Count / sum(Count) * 100, 1)) %>%
  knitr::kable()
```